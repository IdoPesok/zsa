---
title: "Utils and Refetching"
group: "Getting Started"
groupOrder: 4
---

# Utils and refetching

When using server actions to query data, you may need to explicitly refetch that data when it becomes stale. This can be achieved using the `useServerActionsUtils` hook.

First, define a server action that fetches the data you want to refetch. In this example, we'll create an action that returns a random number:

```typescript:actions.ts
"use server"
import { createServerActionWrapper } from "server-actions-wrapper"
import z from "zod"

export const getRandomNumber = createServerActionWrapper()
  .createAction()
  .input(
    z.object({
      min: z.number(),
      max: z.number(),
    }).refine((input) => input.min < input.max)
  )
  .handler(async ({ input, ctx }) => {
    await new Promise((r) => setTimeout(r, 1000))
    return {
      number: Math.floor(Math.random() * (input.max - input.min)) + input.min,
    }
  })
```

This action takes a `min` and `max` value as input, validates that `min` is less than `max`, and returns a random number between those values after a simulated 1-second delay.

Next, use the `useServerAction` hook to call the action in a client component:

```typescript:random-number-display.tsx
"use client"
import { useServerAction } from "@/lib/use-server-action"
import { getRandomNumber } from "./actions"

export default function RandomNumberDisplay() {
  const queryAction = useServerAction(getRandomNumber, {
    input: {
      min: 0,
      max: 10,
    },
    refetchKey: "getRandomNumber"
  })

  return (
    <Card className="not-prose">
      <CardHeader>
        <CardTitle>Random number</CardTitle>
        <CardDescription>
          This fetches a random number upon mounting
        </CardDescription>
      </CardHeader>
      <CardContent className="flex flex-col gap-4">
        <p>Random number:</p>
        {queryAction.isLoading ? 'loading...' : ''}
        {queryAction.isSuccess && <>{JSON.stringify(queryAction.data.number)}</>}
      </CardContent>
    </Card>
  )
}
```

The `useServerAction` hook is called with the `getRandomNumber` action and an options object containing the `input` values and a unique `refetchKey`. The component displays the random number returned by the action.

## Refetching example

To manually refetch the data, use the `useServerActionsUtils` hook in another component:

```typescript:random-number-refetch.tsx
"use client"
import { useServerActionsUtils } from "@/lib/use-server-action"

export default function RandomNumberRefetch() {
  const { refetch } = useServerActionsUtils()

  return (
    <Card className="p-4 w-full ">
      <Button
        onClick={() => {
          refetch("getRandomNumber")
        }}
        className="w-full"
      >
        refetch
      </Button>
    </Card>
  )
}
```

This component renders a button that, when clicked, calls the `refetch` function with the same `refetchKey` used in the `RandomNumberDisplay` component. This will cause the server action to be re-executed and the data to be refreshed.

<ExampleComponent id="random-number-example-display" />

Refetch Button:

<ExampleComponent id="random-number-example-refetch" />

By using the `useServerActionsUtils` hook and assigning a unique `refetchKey` to your server actions, you can easily refetch data when needed in your application.
